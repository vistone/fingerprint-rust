use fingerprint::*; fn main() -> Result<(), Box<dyn std::error::Error>> { println!("üß™ Chrome 136 fingerprintdepthValidate\n"); let profiles = mapped_tls_clients(); let chrome_136 = profiles .get("chrome_136") .expect("Chrome 136 profile should exist"); // 1. Validatecipher suite (Cipher Suites) println!("1Ô∏è‚É£ encryptionsuiteweightValidate:"); let spec = chrome_136.get_client_hello_spec()?; // Getfront 5encryptionsuite (skip GREASE) let first_suites: Vec<u16> = spec .cipher_suites .iter() .filter(|&&s| !fingerprint_tls::tls_config::is_grease_value(s)) .take(5) .cloned() .collect(); println!(" first 5 non- GREASE encryptionsuite:"); for suite in first_suites { println!(" - 0x{:04x}", suite); } // expectfirst is TLS_AES_128_GCM_SHA256 (0x1301) if spec.cipher_suites.contains(&0x1301) { println!(" ‚úÖ including TLS_AES_128_GCM_SHA256"); } // 2. Validate ALPN println!("\n2Ô∏è‚É£ ALPN priorityValidate:"); if let Some(metadata) = &spec.metadata { if let Some(alpn) = metadata.get_alpn() { println!(" configuration ALPN: {:?}", alpn); if alpn.first() == Some(&"h3".to_string()) { println!(" ‚úÖ h3 alreadycorrectput first"); } else { println!(" ‚ùå h3 notput first: {:?}", alpn.first()); } } else { println!(" ‚ùå not found ALPN metadata"); } } // 3. Buildactual bytes stream println!("\n3Ô∏è‚É£ ClientHello bytes streamBuild:"); let client_hello = TLSHandshakeBuilder::build_client_hello(&spec, "www.google.com")?; println!( " ‚úÖ successGenerate ClientHello: {} bytes", client_hello.len() ); // simpleCheck ALPN whether in bytes stream in (h3, h2, http/1.1) if client_hello.windows(2).any(|w| w == b"h3") && client_hello.windows(2).any(|w| w == b"h2") { println!(" ‚úÖ bytes stream in including h3 and h2 identifier"); } // 4. JA4 fingerprintValidate println!("\n4Ô∏è‚É£ JA4 fingerprintmainGenerate:"); let ja4 = chrome_136.get_ja4_string()?; println!(" ‚úÖ JA4: {}", ja4); println!("\n‚ú® Chrome 136 fine-tuneValidatethroughÔºÅ"); Ok(())
}
