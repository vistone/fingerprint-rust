# å®‰å…¨ä¿®å¤å¤æŸ¥æŠ¥å‘Š

**å¤æŸ¥æ—¥æœŸ**: 2025-12-29  
**å¤æŸ¥äººå‘˜**: Antigravity AI Security Analyzer  
**çŠ¶æ€æ¦‚è§ˆ**: å¤§éƒ¨åˆ†é«˜å±æ¼æ´å·²ä¿®å¤ï¼Œä»æœ‰å°‘é‡å»ºè®®

---

## âœ… å·²éªŒè¯ä¿®å¤

ä»¥ä¸‹é«˜å±æ¼æ´å·²ç¡®è®¤è¢«æ­£ç¡®ä¿®å¤ï¼š

1.  **HTTP å“åº”è§£æç¼“å†²åŒºæº¢å‡º**
    -   çŠ¶æ€: âœ… å·²ä¿®å¤
    -   ä½ç½®: `crates/fingerprint-http/src/http_client/io.rs`
    -   éªŒè¯: ä»£ç ä¸­å·²æ·»åŠ  `MAX_CONTENT_LENGTH` (100MB) æ£€æŸ¥ã€‚

2.  **Chunked Encoding è§£ææ¼æ´**
    -   çŠ¶æ€: âœ… å·²ä¿®å¤
    -   ä½ç½®: `crates/fingerprint-http/src/http_client/response.rs`
    -   éªŒè¯: ä»£ç ä¸­å·²æ·»åŠ  `MAX_CHUNK_SIZE` (10MB) æ£€æŸ¥ã€‚

3.  **IPInfo Token æ³„éœ²**
    -   çŠ¶æ€: âœ… å·²ä¿®å¤
    -   ä½ç½®: `crates/fingerprint-dns/src/dns/ipinfo.rs`
    -   éªŒè¯: Token å·²æ”¹ä¸ºé€šè¿‡ `Authorization` Header ä¼ é€’ï¼Œä¸å†å‡ºç°åœ¨ URL ä¸­ã€‚

4.  **æ— é™é‡å®šå‘å¾ªç¯**
    -   çŠ¶æ€: âœ… å·²ä¿®å¤
    -   ä½ç½®: `crates/fingerprint-http/src/http_client/mod.rs`
    -   éªŒè¯: å®ç°äº† `visited_urls` é›†åˆæ¥æ£€æµ‹å¾ªç¯é‡å®šå‘ã€‚

5.  **DNS é”ä¸­æ¯’ä¸æ–‡ä»¶ç«æ€**
    -   çŠ¶æ€: âœ… å·²ä¿®å¤
    -   ä½ç½®: `crates/fingerprint-dns/src/dns/serverpool.rs`
    -   éªŒè¯: å…³é”®è·¯å¾„çš„ `unwrap()` å·²ç§»é™¤ï¼Œæ–‡ä»¶å†™å…¥ä½¿ç”¨äº†è¿›ç¨‹ ID é¿å…ç«æ€ã€‚

---

## âš ï¸ é—ç•™é—®é¢˜ä¸å»ºè®®

### 1. TLS éšæœºæ•°ç”Ÿæˆ (fingerprint-tls)

**é—®é¢˜æè¿°**: è™½ç„¶æ·»åŠ äº† `/dev/urandom` çš„æ”¯æŒï¼Œä½†åœ¨æ— æ³•è®¿é—®æ—¶ï¼ˆä¾‹å¦‚ Windows æˆ– chroot ç¯å¢ƒï¼‰ï¼Œä»£ç ä»å›é€€åˆ°ä¸å®‰å…¨çš„ `DefaultHasher` å’Œçº¿æ€§åŒä½™ç”Ÿæˆå™¨ (LCG)ã€‚æ­¤å¤–ï¼Œ`Cargo.toml` ä¸­ `default` feature æ²¡æœ‰å¼€å¯ `crypto`ã€‚

**æ–‡ä»¶**: `crates/fingerprint-tls/src/tls_handshake/messages.rs`

**å»ºè®®ä¿®å¤**:
1.  **å¼ºåˆ¶å®‰å…¨**: åœ¨ `#[cfg(not(feature = "crypto"))]` åˆ†æ”¯ä¸­ï¼Œå¦‚æœ `/dev/urandom` ä¸å¯ç”¨ï¼Œ**åº”è¯¥ç›´æ¥è¿”å›é”™è¯¯**ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ä¸å®‰å…¨çš„ä¼ªéšæœºæ•°ã€‚TLS æ¡æ‰‹çš„éšæœºæ•°å®‰å…¨æ€§è‡³å…³é‡è¦ã€‚
2.  **é»˜è®¤é…ç½®**: ä¿®æ”¹ `crates/fingerprint-tls/Cargo.toml`ï¼Œå°† `crypto` åŠ å…¥é»˜è®¤ featureã€‚

```toml
[features]
default = ["crypto"]
```

### 2. DNS å¥åº·æ£€æŸ¥å†…å­˜ä¼˜åŒ–

**é—®é¢˜æè¿°**: `health_check_and_save_incremental` å‡½æ•°é™åˆ¶äº†å¹¶å‘è¿æ¥æ•°ï¼Œä½†ä¼šä¸€æ¬¡æ€§åˆ›å»ºæ‰€æœ‰ä»»åŠ¡çš„ Futureã€‚å¦‚æœæœåŠ¡å™¨åˆ—è¡¨éå¸¸å¤§ï¼ˆç™¾ä¸‡çº§ï¼‰ï¼Œè¿™å¯èƒ½ä¼šæ¶ˆè€—å¤§é‡å†…å­˜ã€‚

**æ–‡ä»¶**: `crates/fingerprint-dns/src/dns/serverpool.rs`

**å»ºè®®ä¿®å¤**:
å®ç°çœŸæ­£çš„åˆ†æ‰¹å¤„ç†ï¼ˆChunkingï¼‰ï¼Œå³æ¯æ¬¡åªä»è¿­ä»£å™¨ä¸­å–å‡º `BATCH_SIZE` ä¸ªå…ƒç´ è¿›è¡Œå¤„ç†ï¼Œè€Œä¸æ˜¯ä¸€æ¬¡æ€§ map æ‰€æœ‰å…ƒç´ ã€‚

```rust
// ä¼ªä»£ç ç¤ºä¾‹
for chunk in servers.chunks(1000) {
    let tasks = stream::iter(chunk).map(...).buffer_unordered(concurrency);
    tasks.collect().await;
}
```

---

## ğŸ ç»“è®º

é¡¹ç›®å®‰å…¨æ€§å·²å¾—åˆ°æ˜¾è‘—æå‡ï¼Œæ‰€æœ‰æœ€å±é™©çš„è¿œç¨‹å¯åˆ©ç”¨æ¼æ´ï¼ˆç¼“å†²åŒºæº¢å‡ºã€ä¿¡æ¯æ³„éœ²ï¼‰å‡å·²ä¿®å¤ã€‚å‰©ä¸‹çš„é—®é¢˜ä¸»è¦æ˜¯ç”±é…ç½®å¯¼è‡´çš„æ½œåœ¨ä¸å®‰å…¨å›é€€ï¼ˆTLS éšæœºæ•°ï¼‰ï¼Œä»¥åŠæç«¯æƒ…å†µä¸‹çš„èµ„æºä¼˜åŒ–ï¼ˆDNS å†…å­˜ï¼‰ã€‚

å»ºè®®åœ¨å‘å¸ƒå‰ä¿®æ”¹ `Cargo.toml` é»˜è®¤é…ç½®ï¼Œä»¥ç¡®ä¿ç”¨æˆ·é»˜è®¤è·å¾—æœ€å®‰å…¨çš„ä½“éªŒã€‚
