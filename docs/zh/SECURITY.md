# 安全政策

## 支持的版本

我们重视安全，并为以下版本提供安全更新：

| 版本 | 支持 | 说明 |
| ------- | ------------------ | ---------------------------- |
| 2.1.x   | :white_check_mark: | 当前稳定版本 |
| 2.0.x   | :white_check_mark: | LTS，仅安全修复 |
| < 2.0   | :x:                | 生命周期结束，建议升级 |

## 报告安全漏洞

**请勿通过公开的GitHub问题报告安全漏洞。**

相反，请通过以下方式之一私下报告：

### 1. GitHub安全公告（推荐）

1. 转到 https://github.com/vistone/fingerprint-rust/security/advisories
2. 点击"New draft security advisory"（新建草稿安全公告）
3. 提供有关漏洞的详细信息
4. 提交公告

### 2. 电子邮件

将详情发送至项目维护者（联系信息在仓库中）

### 包含的内容

报告漏洞时，请包含：

- **描述**：漏洞的清楚描述
- **影响**：攻击者可以做什么？
- **复现**：分步复现说明
- **受影响的版本**：哪些版本存在漏洞？
- **建议的修复**：如果您有（可选）
- **概念验证**：代码、数据包捕获等（如适用）

### 报告示例

```markdown
**摘要**：数据包解析中的缓冲区溢出

**影响**：使用精心构造的IPv4数据包可能导致远程代码执行

**复现**：
1. 创建IHL < 5的畸形IPv4数据包
2. 发送给应用程序
3. 应用程序因分段故障崩溃

**受影响的版本**：2.0.0 - 2.1.0

**建议的修复**：添加验证：if ihl < 5 || ihl > 15 { return error }

**POC**：[附加pcap文件]
```

## 响应时间表

- **初步响应**：48小时内
- **评估**：7天内
- **修复开发**：根据严重程度
  - 关键：1-7天
  - 高：7-14天
  - 中：14-30天
  - 低：30-90天
- **公开披露**：修复发布后

## 严重程度分类

我们使用CVSS v3.1进行严重程度评估：

| 严重程度 | CVSS评分 | 响应时间 |
|----------|------------|---------------|
| 关键 | 9.0-10.0   | 1-7天      |
| 高     | 7.0-8.9    | 7-14天     |
| 中   | 4.0-6.9    | 14-30天    |
| 低      | 0.1-3.9    | 30-90天    |

## 安全更新流程

1. **开发修复**：在私有分支中创建补丁
2. **内部审查**：安全团队审查修复
3. **测试**：包括回归测试的全面测试
4. **准备发布**：创建包含修复的新版本
5. **协调披露**：
   - 通知报告人
   - 准备安全公告
   - 更新CHANGELOG
6. **发布**：发布修复版本
7. **公开披露**：发布安全公告
8. **通知用户**：通过GitHub、社交媒体等宣布

## 我们认为的安全问题

### 范围内

- **内存安全**：缓冲区溢出、释放后使用等
- **拒绝服务**：资源耗尽、无限循环
- **输入验证**：解析漏洞、注入攻击
- **信息泄露**：意外数据泄漏
- **加密问题**：算法弱、使用不当
- **身份验证/授权**：绕过漏洞
- **代码执行**：RCE、任意代码执行

### 范围外

- 依赖项中的问题（报告给上游）
- 需要物理接入的问题
- 社会工程攻击
- 需要大量资源的拒绝服务
- 仅影响过时/不支持版本的问题
- 没有实际影响的理论漏洞

## 漏洞披露政策

我们遵循**协调漏洞披露**：

1. **私下报告**：私下报告漏洞
2. **确认**：我们在48小时内确认收到
3. **调查**：我们调查并验证报告
4. **开发**：我们开发并测试修复
5. **协调**：我们与报告人协调披露时间
6. **公开披露**：修复发布后我们公开披露

### 披露时间表

- **标准**：初始报告后90天
- **延长**：如果修复需要更多时间，我们可能要求延长
- **立即**：如果漏洞正在被主动利用

## 用户安全最佳实践

### 安装

```toml
# 始终使用特定版本
[dependencies]
fingerprint = "2.1.0"  # 不是"2.1"或"2"
```

### 更新

```bash
# 定期检查更新
cargo update

# 检查安全公告
cargo audit
```

### 配置

```rust
// 使用安全的默认值
let config = HttpClientConfig {
    // 启用TLS验证
    verify_ssl: true,
    
    // 设置合理的超时
    timeout: Duration::from_secs(30),
    
    // 限制重定向
    max_redirects: 5,
    
    ..Default::default()
};
```

### 网络安全

- 对所有连接使用HTTPS
- 验证SSL/TLS证书
- 设置适当的超时
- 限制请求/响应大小
- 实施速率限制

### 输入验证

```rust
// 始终验证外部输入
fn process_packet(data: &[u8]) -> Result<(), Error> {
    // 检查大小
    if data.len() < MIN_SIZE || data.len() > MAX_SIZE {
        return Err(Error::InvalidSize);
    }
    
    // 验证格式
    if !is_valid_format(data) {
        return Err(Error::InvalidFormat);
    }
    
    // 处理...
    Ok(())
}
```

## 安全功能

### 当前

- ✅ 内存安全的Rust实现
- ✅ 对所有外部数据的输入验证
- ✅ 数组访问的边界检查
- ✅ 安全的整数算术
- ✅ TLS 1.3支持
- ✅ 证书验证
- ✅ 超时保护
- ✅ 数据包/请求的大小限制
- ✅ DoS防护（速率限制、资源限制）

### 计划中

- ⏳ 模糊测试集成（cargo-fuzz）
- ⏳ 基于属性的测试（proptest）
- ⏳ 内存分析
- ⏳ 静态分析集成（MIRI）
- ⏳ 自动依赖扫描

## 安全审计

### 最近的审计

| 日期 | 审计人员 | 范围 | 状态 |
|------------|----------------|----------------|----------|
| 2026-01-02 | GitHub Copilot | 完整代码库 | 完成 |

### 审计报告

可在以下位置获得：
- `SECURITY_AUDIT.md` - 详细审计报告
- `SECURITY_IMPROVEMENTS.md` - 改进跟踪

## 漏洞赏金计划

**状态**：目前不可用

我们感谢安全研究人员，但目前不提供正式的漏洞赏金计划。但是，我们会：

- 在发布说明中确认您的贡献
- 在安全公告中署名您（如果需要）
- 及时和专业地回应

## 安全倡导者

安全是每个人的责任。但是，我们指定了安全倡导者：

- **主要联系人**：项目维护者
- **安全审查**：所有代码更改都接受安全审查
- **漏洞管理**：通过GitHub安全进行协调

## 合规性

本项目遵循：

- **OWASP Top 10** 网络应用安全风险
- **CWE Top 25** 最危险的软件弱点
- **Rust安全指南**
- **NIST网络安全框架**（如适用）

## 资源

### 学习

- [Rust安全书](https://anssi-fr.github.io/rust-guide/)
- [OWASP速查表](https://cheatsheetseries.owasp.org/)
- [CWE Top 25](https://cwe.mitre.org/top25/)

### 工具

- `cargo audit` - 检查已知漏洞
- `cargo deny` - 依赖政策执行
- `cargo fuzz` - 模糊测试框架
- `clippy` - 代码检查和最佳实践

### 社区

- GitHub讨论 - 用于安全问题
- GitHub问题 - 用于非安全漏洞
- GitHub安全公告 - 用于漏洞报告

## 此政策的更改

此安全政策可能不时更新。重大更改将通过以下方式公布：

- GitHub发布说明
- 安全公告
- 项目文档

**最后更新**：2026-01-06  
**版本**：1.0  
**下次审查**：2026-04-06
