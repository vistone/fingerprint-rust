# 安全政策

## 支持的版本

我们重视安全，为以下版本提供安全更新：

| 版本 | 支持状态       | 备注                        |
| ------- | --------------- | ---------------------------- |
| 2.1.x   | ✅ 支持         | 当前稳定版本                 |
| 2.0.x   | ✅ 支持         | LTS 版本，仅提供安全补丁      |
| < 2.0   | ❌ 不支持       | 生命周期已结束，建议升级     |

## 报告安全漏洞

**请不要通过公开的 GitHub Issues 报告安全漏洞。**

请通过以下方式之一私密报告：

### 1. GitHub 安全公告（推荐）

1. 访问 https://github.com/vistone/fingerprint-rust/security/advisories
2. 点击"New draft security advisory"（新建安全公告草稿）
3. 提供关于漏洞的详细信息
4. 提交公告

### 2. 电子邮件

将详细信息发送给项目维护者（联系方式见仓库）

### 报告内容要求

报告安全漏洞时，请包含以下内容：

- **漏洞描述**：清晰、详细的漏洞说明
- **影响范围**：攻击者可能造成什么伤害？
- **复现步骤**：分步骤说明如何复现漏洞
- **受影响版本**：哪些版本容易受到影响？
- **建议修复方案**：如果有建议（可选）
- **概念验证**：代码、数据包捕获等（如果适用）

### 报告示例

```markdown
**摘要**: IPv4 数据包解析中的缓冲区溢出

**影响**: 使用精心构造的 IPv4 数据包可能导致远程代码执行

**复现步骤**:
1. 创建格式错误的 IPv4 数据包，IHL < 5
2. 发送给应用程序
3. 应用程序因分段错误而崩溃

**受影响的版本**: 2.0.0 - 2.1.0

**建议修复**: 添加验证：if ihl < 5 || ihl > 15 { return error }

**概念验证**: [附加 pcap 文件]
```

## 响应时间表

- **初始响应**：48 小时内
- **评估**：7 天内
- **修复开发**：取决于严重程度
  - 严重漏洞：1-7 天
  - 高风险：7-14 天
  - 中等风险：14-30 天
  - 低风险：30-90 天
- **公开披露**：修复发布后

## 严重程度分类

我们使用 CVSS v3.1 进行严重程度评估：

| 严重程度 | CVSS 评分 | 响应时间   |
|----------|---------|----------|
| 严重     | 9.0-10.0 | 1-7 天   |
| 高       | 7.0-8.9  | 7-14 天  |
| 中等     | 4.0-6.9  | 14-30 天 |
| 低       | 0.1-3.9  | 30-90 天 |

## 安全更新流程

1. **开发修复**：在私有分支中创建补丁
2. **内部审查**：安全团队审查修复方案
3. **测试**：进行包括回归测试在内的全面测试
4. **准备发布**：创建包含修复的新版本
5. **协调披露**：
   - 通知报告者
   - 准备安全公告
   - 更新 CHANGELOG
6. **发布**：发布修复版本
7. **公开披露**：发布安全公告
8. **通知用户**：通过 GitHub、社交媒体等方式公告

## 安全问题的定义

### 范围内

- **内存安全**：缓冲区溢出、使用已释放内存等
- **拒绝服务**：资源耗尽、无限循环
- **输入验证**：解析漏洞、注入攻击
- **信息泄露**：意外数据泄露
- **密码学问题**：薄弱算法、不当使用
- **身份验证/授权**：绕过漏洞
- **代码执行**：远程代码执行、任意代码执行

### 范围外

- 依赖关系中的问题（报告给上游）
- 需要物理访问的问题
- 社交工程攻击
- 需要大量资源的拒绝服务
- 仅影响过时/不支持版本的问题
- 没有实际影响的理论漏洞

## 漏洞披露政策

我们遵循**协调漏洞披露**方式：

1. **私密报告**：私密报告漏洞
2. **确认收到**：我们在 48 小时内确认收到
3. **调查验证**：我们调查并验证报告
4. **开发修复**：我们开发并测试修复方案
5. **协调披露**：我们与报告者协调披露时间
6. **公开披露**：修复发布后公开披露

### 披露时间表

- **标准**：初始报告后 90 天
- **延期**：如果修复需要更多时间，我们可能请求延期
- **立即**：如果漏洞正在被积极利用

## 用户安全最佳实践

### 安装

```toml
# 始终使用具体版本
[dependencies]
fingerprint = "2.1.0"  # 不要使用 "2.1" 或 "2"
```

### 更新

```bash
# 定期检查更新
cargo update

# 检查安全公告
cargo audit
```

### 配置

```rust
// 使用安全的默认设置
let config = HttpClientConfig {
    // 启用 TLS 验证
    verify_ssl: true,
    
    // 设置合理的超时
    timeout: Duration::from_secs(30),
    
    // 限制重定向数量
    max_redirects: 5,
    
    ..Default::default()
};
```

### 网络安全

- 对所有连接使用 HTTPS
- 验证 SSL/TLS 证书
- 设置适当的超时
- 限制请求/响应大小
- 实现速率限制

### 输入验证

```rust
// 始终验证外部输入
fn process_packet(data: &[u8]) -> Result<(), Error> {
    // 检查大小
    if data.len() < MIN_SIZE || data.len() > MAX_SIZE {
        return Err(Error::InvalidSize);
    }
    
    // 验证格式
    if !is_valid_format(data) {
        return Err(Error::InvalidFormat);
    }
    
    // 处理...
    Ok(())
}
```

## 安全功能

### 现有功能

- ✅ 使用 Rust 实现的内存安全
- ✅ 对所有外部数据的输入验证
- ✅ 数组访问的界限检查
- ✅ 安全的整数运算
- ✅ TLS 1.3 支持
- ✅ 证书验证
- ✅ 超时保护
- ✅ 数据包/请求大小限制
- ✅ 拒绝服务保护（速率限制、资源限制）

### 计划中的功能

- ⏳ Fuzzing 集成（cargo-fuzz）
- ⏳ 属性测试（proptest）
- ⏳ 内存分析
- ⏳ 静态分析集成（MIRI）
- ⏳ 自动依赖扫描

## 安全审计

### 最近的审计

| 日期       | 审计者         | 范围         | 状态   |
|-----------|------------|-----------|------|
| 2026-01-02 | GitHub Copilot | 完整代码库 | 完成 |

### 审计报告

可在以下位置获取：
- `SECURITY_AUDIT.md` - 详细审计报告
- `SECURITY_IMPROVEMENTS.md` - 改进跟踪

## bug 赏金计划

**状态**：目前不可用

我们感谢安全研究人员，但目前不提供正式的 bug 赏金计划。但是，我们会：

- 在发布说明中认可你的贡献
- 在安全公告中承认你（如果需要）
- 迅速、专业地回应

## 安全冠军

安全是每个人的责任。但是，我们指定了安全冠军：

- **主要联系人**：项目维护者
- **安全审查**：所有代码变更都经过安全审查
- **漏洞管理**：通过 GitHub Security 协调

## 合规性

本项目遵循：

- **OWASP Top 10** 网络应用程序安全风险
- **CWE Top 25** 最危险的软件弱点
- **Rust 安全指南**
- **NIST 网络安全框架**（如适用）

## 资源

### 学习资源

- [Rust 安全手册](https://anssi-fr.github.io/rust-guide/)
- [OWASP 速查表](https://cheatsheetseries.owasp.org/)
- [CWE Top 25](https://cwe.mitre.org/top25/)

### 工具

- `cargo audit` - 检查已知漏洞
- `cargo deny` - 依赖关系政策执行
- `cargo fuzz` - Fuzzing 框架
- `clippy` - Linting 和最佳实践

### 社区

- GitHub Discussions - 安全问题讨论
- GitHub Issues - 非安全类 bug 报告
- GitHub Security Advisories - 漏洞报告

## 本政策的更改

本安全政策可能会不时更新。重大更改将通过以下方式公告：

- GitHub 发布说明
- 安全公告
- 项目文档

**最后更新**: 2026-01-06  
**版本**: 1.0  
**下次审查**: 2026-04-06
